<div class="min-h-screen bg-gray-50 p-6">
  <!-- Header Section -->
  <div class="bg-white rounded-xl shadow-sm border border-gray-200 p-6 mb-6">
    <div class="flex flex-col lg:flex-row lg:items-center lg:justify-between gap-4">
      <div class="flex-1">
        <h1 class="text-2xl lg:text-3xl font-bold text-gray-900 mb-2">{{ isEditMode ? '‚úèÔ∏è Edit Disbursement' : '‚ûï New Disbursement' }}</h1>
        <p class="text-gray-600">{{ isEditMode ? 'Update disbursement information' : 'Create a new financial disbursement record' }}</p>
      </div>
      <div class="flex gap-3">
        <button class="px-4 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition-colors duration-200" 
                (click)="onCancel()">
          ‚ùå Cancel
        </button>
        <button class="px-4 py-2 bg-red-100 text-red-700 rounded-lg hover:bg-red-200 transition-colors duration-200" 
                (click)="onReset()" 
                *ngIf="!isEditMode">
          üîÑ Reset
        </button>
      </div>
    </div>
  </div>

  <!-- Loading State -->
  <div *ngIf="isLoading" class="flex flex-col items-center justify-center py-12">
    <div class="text-4xl mb-4 animate-spin">‚è≥</div>
    <p class="text-gray-600">Loading disbursement data...</p>
  </div>

  <!-- Error Message -->
  <div *ngIf="error" class="bg-red-50 border border-red-200 text-red-700 p-4 rounded-xl mb-6 flex items-center gap-3">
    <span class="text-xl">‚ö†Ô∏è</span>
    {{ error }}
  </div>

  <!-- Success Message -->
  <div *ngIf="successMessage" class="bg-green-50 border border-green-200 text-green-700 p-4 rounded-xl mb-6 flex items-center gap-3">
    <span class="text-xl">‚úÖ</span>
    {{ successMessage }}
  </div>

  <!-- Form Content -->
  <div *ngIf="!isLoading" class="max-w-4xl mx-auto">
    <form [formGroup]="disbursementForm" (ngSubmit)="onSubmit()" class="space-y-6">
      
      <!-- Basic Information Section -->
      <div class="bg-white rounded-xl shadow-sm border border-gray-200 p-6">
        <h3 class="text-lg font-semibold text-gray-900 mb-6 flex items-center gap-2">
          <span class="text-xl">üìã</span>
          Basic Information
        </h3>
        
        <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
          <!-- Disbursement Number -->
          <div>
            <label for="disbursementNo" class="block text-sm font-medium text-gray-700 mb-2">
              Disbursement Number <span class="text-red-500">*</span>
            </label>
            <input
              type="text"
              id="disbursementNo"
              formControlName="disbursementNo"
              placeholder="Auto-generated"
              class="w-full px-3 py-2 border border-gray-300 rounded-lg bg-gray-50 text-gray-500"
              readonly
            />
            <div *ngIf="isFieldInvalid('disbursementNo')" class="text-red-500 text-sm mt-1">
              {{ getFieldError('disbursementNo') }}
            </div>
          </div>

          <!-- Disbursement Date -->
          <div>
            <label for="disbursementDate" class="block text-sm font-medium text-gray-700 mb-2">
              Disbursement Date <span class="text-red-500">*</span>
            </label>
            <input
              type="date"
              id="disbursementDate"
              formControlName="disbursementDate"
              class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500"
              [class.border-red-500]="isFieldInvalid('disbursementDate')"
            />
            <div *ngIf="isFieldInvalid('disbursementDate')" class="text-red-500 text-sm mt-1">
              {{ getFieldError('disbursementDate') }}
            </div>
          </div>
        </div>

        <div class="mb-6">
          <!-- Payee -->
          <label for="payee" class="block text-sm font-medium text-gray-700 mb-2">
            Payee <span class="text-red-500">*</span>
          </label>
          <input
            type="text"
            id="payee"
            formControlName="payee"
            placeholder="Enter payee name or organization"
            class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500"
            [class.border-red-500]="isFieldInvalid('payee')"
          />
          <div *ngIf="isFieldInvalid('payee')" class="text-red-500 text-sm mt-1">
            {{ getFieldError('payee') }}
          </div>
        </div>

        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
          <!-- Amount -->
          <div>
            <label for="amount" class="block text-sm font-medium text-gray-700 mb-2">
              Amount (PHP) <span class="text-red-500">*</span>
            </label>
            <div class="relative">
              <span class="absolute left-3 top-2 text-gray-500">‚Ç±</span>
              <input
                type="number"
                id="amount"
                formControlName="amount"
                placeholder="0.00"
                step="0.01"
                min="0"
                class="w-full pl-8 pr-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500"
                [class.border-red-500]="isFieldInvalid('amount')"
              />
            </div>
            <div *ngIf="isFieldInvalid('amount')" class="text-red-500 text-sm mt-1">
              {{ getFieldError('amount') }}
            </div>
            <div *ngIf="disbursementForm.get('amount')?.value" class="text-sm text-gray-600 mt-1">
              Preview: {{ formatCurrency(disbursementForm.get('amount')?.value) }}
            </div>
          </div>

          <!-- Department -->
          <div>
            <label for="department" class="block text-sm font-medium text-gray-700 mb-2">
              Department <span class="text-red-500">*</span>
            </label>
            <select
              id="department"
              formControlName="department"
              class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500"
              [class.border-red-500]="isFieldInvalid('department')"
            >
              <option value="">Select Department</option>
              <option *ngFor="let dept of departments" [value]="dept">
                {{ dept }}
              </option>
            </select>
            <div *ngIf="isFieldInvalid('department')" class="text-red-500 text-sm mt-1">
              {{ getFieldError('department') }}
            </div>
          </div>
        </div>
      </div>

      <!-- Classification Section -->
      <div class="bg-white rounded-xl shadow-sm border border-gray-200 p-6">
        <h3 class="text-lg font-semibold text-gray-900 mb-6 flex items-center gap-2">
          <span class="text-xl">üè∑Ô∏è</span>
          Classification
        </h3>
        
        <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
          <!-- Classification -->
          <div>
            <label for="classification" class="block text-sm font-medium text-gray-700 mb-2">
              Classification <span class="text-red-500">*</span>
            </label>
            <select
              id="classification"
              formControlName="classification"
              class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500"
              [class.border-red-500]="isFieldInvalid('classification')"
            >
              <option value="">Select Classification</option>
              <option *ngFor="let classification of classifications" [value]="classification.value">
                {{ classification.icon }} {{ classification.label }}
              </option>
            </select>
            <div *ngIf="isFieldInvalid('classification')" class="text-red-500 text-sm mt-1">
              {{ getFieldError('classification') }}
            </div>
            <div *ngIf="disbursementForm.get('classification')?.value" class="text-sm text-gray-600 mt-1">
              {{ getClassificationInfo(disbursementForm.get('classification')?.value)?.description }}
            </div>
          </div>

          <!-- Sub-classification -->
          <div>
            <label for="subClassification" class="block text-sm font-medium text-gray-700 mb-2">
              Sub-classification
            </label>
            <input
              type="text"
              id="subClassification"
              formControlName="subClassification"
              placeholder="Optional sub-category"
              class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500"
            />
          </div>
        </div>

        <div>
          <!-- Fund Source -->
          <label for="fundSource" class="block text-sm font-medium text-gray-700 mb-2">
            Fund Source <span class="text-red-500">*</span>
          </label>
          <select
            id="fundSource"
            formControlName="fundSource"
            class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500"
            [class.border-red-500]="isFieldInvalid('fundSource')"
          >
            <option value="">Select Fund Source</option>
            <option *ngFor="let source of fundSources" [value]="source">
              {{ source }}
            </option>
          </select>
          <div *ngIf="isFieldInvalid('fundSource')" class="text-red-500 text-sm mt-1">
            {{ getFieldError('fundSource') }}
          </div>
        </div>
      </div>

      <!-- Description Section -->
      <div class="bg-white rounded-xl shadow-sm border border-gray-200 p-6">
        <h3 class="text-lg font-semibold text-gray-900 mb-6 flex items-center gap-2">
          <span class="text-xl">üìù</span>
          Description & Details
        </h3>
        
        <div class="mb-6">
          <!-- Description -->
          <label for="description" class="block text-sm font-medium text-gray-700 mb-2">
            Description <span class="text-red-500">*</span>
          </label>
          <textarea
            id="description"
            formControlName="description"
            placeholder="Provide detailed description of the disbursement purpose and details"
            rows="4"
            class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 resize-none"
            [class.border-red-500]="isFieldInvalid('description')"
          ></textarea>
          <div *ngIf="isFieldInvalid('description')" class="text-red-500 text-sm mt-1">
            {{ getFieldError('description') }}
          </div>
          <div class="text-sm text-gray-500 mt-1">
            {{ disbursementForm.get('description')?.value?.length || 0 }} characters
          </div>
        </div>

        <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
          <!-- Check Number -->
          <div>
            <label for="checkNo" class="block text-sm font-medium text-gray-700 mb-2">
              Check Number
            </label>
            <input
              type="text"
              id="checkNo"
              formControlName="checkNo"
              placeholder="Optional check number"
              class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500"
            />
          </div>

          <!-- Voucher Number -->
          <div>
            <label for="voucherNo" class="block text-sm font-medium text-gray-700 mb-2">
              Voucher Number
            </label>
            <input
              type="text"
              id="voucherNo"
              formControlName="voucherNo"
              placeholder="Optional voucher number"
              class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500"
            />
          </div>
        </div>

        <div>
          <!-- Remarks -->
          <label for="remarks" class="block text-sm font-medium text-gray-700 mb-2">
            Remarks
          </label>
          <textarea
            id="remarks"
            formControlName="remarks"
            placeholder="Additional notes or comments (optional)"
            rows="3"
            class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 resize-none"
          ></textarea>
        </div>
      </div>

      <!-- Form Actions -->
      <div class="bg-white rounded-xl shadow-sm border border-gray-200 p-6">
        <div class="flex flex-col sm:flex-row gap-3 justify-end">
          <button
            type="button"
            class="px-6 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition-colors duration-200"
            (click)="onCancel()"
          >
            ‚ùå Cancel
          </button>
          
          <button
            type="button"
            class="px-6 py-2 bg-red-100 text-red-700 rounded-lg hover:bg-red-200 transition-colors duration-200"
            (click)="onReset()"
            *ngIf="!isEditMode"
          >
            üîÑ Reset Form
          </button>
          
          <button
            type="submit"
            class="px-6 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 transition-colors duration-200 disabled:opacity-50 disabled:cursor-not-allowed"
            [disabled]="isSubmitting || disbursementForm.invalid || !canEdit()"
          >
            <span *ngIf="isSubmitting" class="inline-block animate-spin mr-2">‚è≥</span>
            <span *ngIf="!isSubmitting">
              {{ isEditMode ? 'üíæ Update Disbursement' : '‚ûï Create Disbursement' }}
            </span>
          </button>
        </div>
        
        <div *ngIf="disbursementForm.invalid && disbursementForm.touched" class="mt-6 p-4 bg-yellow-50 border border-yellow-200 rounded-lg">
          <h4 class="font-medium text-yellow-800 mb-3 flex items-center gap-2">
            <span>‚ö†Ô∏è</span>
            Please fix the following errors:
          </h4>
          <ul class="text-sm text-yellow-700 space-y-1">
            <li *ngIf="disbursementForm.get('disbursementNo')?.invalid && disbursementForm.get('disbursementNo')?.touched">
              ‚Ä¢ Disbursement number is required
            </li>
            <li *ngIf="disbursementForm.get('payee')?.invalid && disbursementForm.get('payee')?.touched">
              ‚Ä¢ Payee name is required (minimum 2 characters)
            </li>
            <li *ngIf="disbursementForm.get('amount')?.invalid && disbursementForm.get('amount')?.touched">
              ‚Ä¢ Valid amount is required (must be greater than 0)
            </li>
            <li *ngIf="disbursementForm.get('disbursementDate')?.invalid && disbursementForm.get('disbursementDate')?.touched">
              ‚Ä¢ Disbursement date is required
            </li>
            <li *ngIf="disbursementForm.get('description')?.invalid && disbursementForm.get('description')?.touched">
              ‚Ä¢ Description is required (minimum 10 characters)
            </li>
            <li *ngIf="disbursementForm.get('fundSource')?.invalid && disbursementForm.get('fundSource')?.touched">
              ‚Ä¢ Fund source selection is required
            </li>
            <li *ngIf="disbursementForm.get('classification')?.invalid && disbursementForm.get('classification')?.touched">
              ‚Ä¢ Classification selection is required
            </li>
            <li *ngIf="disbursementForm.get('department')?.invalid && disbursementForm.get('department')?.touched">
              ‚Ä¢ Department selection is required
            </li>
          </ul>
        </div>
      </div>
    </form>
  </div>
</div>