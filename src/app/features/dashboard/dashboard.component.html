<div class="dashboard-container">
  <!-- Header Section -->
  <div class="dashboard-header">
    <div class="greeting-section">
      <h1 class="greeting">{{ getGreeting() }}, {{ getUserDisplayName() }}!</h1>
      <p class="role-badge">{{ getRoleDisplayName() }}</p>
    </div>
    <div class="date-section">
      <p class="current-date">{{ currentDate | date:'fullDate' }}</p>
    </div>
  </div>

  <!-- Loading State -->
  <div *ngIf="isLoading" class="loading-container">
    <div class="loading-spinner"></div>
    <p>Loading dashboard data...</p>
  </div>

  <!-- Dashboard Content -->
  <div *ngIf="!isLoading" class="dashboard-content">
    <!-- Stats Cards -->
    <div class="stats-grid">
      <div class="stat-card total-disbursements">
        <div class="stat-icon">
          <i class="fas fa-file-invoice-dollar"></i>
        </div>
        <div class="stat-content">
          <h3>{{ stats.totalDisbursements }}</h3>
          <p>Total Disbursements</p>
        </div>
      </div>

      <div class="stat-card total-amount">
        <div class="stat-icon">
          <i class="fas fa-peso-sign"></i>
        </div>
        <div class="stat-content">
          <h3>{{ formatCurrency(stats.totalAmount) }}</h3>
          <p>Total Amount</p>
        </div>
      </div>

      <div class="stat-card monthly-disbursements">
        <div class="stat-icon">
          <i class="fas fa-calendar-month"></i>
        </div>
        <div class="stat-content">
          <h3>{{ stats.monthlyDisbursements }}</h3>
          <p>This Month</p>
        </div>
      </div>

      <div class="stat-card pending-count">
        <div class="stat-icon">
          <i class="fas fa-clock"></i>
        </div>
        <div class="stat-content">
          <h3>{{ stats.pendingCount }}</h3>
          <p>Pending</p>
        </div>
      </div>
    </div>

    <!-- Classification Breakdown -->
    <div class="classification-section">
      <h2>Classification Breakdown</h2>
      <div class="classification-grid">
        <div class="classification-card ps">
          <div class="classification-header">
            <i [class]="getClassificationIcon('PS')"></i>
            <span>Personal Services</span>
          </div>
          <div class="classification-amount">{{ formatCurrency(stats.classificationBreakdown.PS) }}</div>
        </div>

        <div class="classification-card mooe">
          <div class="classification-header">
            <i [class]="getClassificationIcon('MOOE')"></i>
            <span>MOOE</span>
          </div>
          <div class="classification-amount">{{ formatCurrency(stats.classificationBreakdown.MOOE) }}</div>
        </div>

        <div class="classification-card co">
          <div class="classification-header">
            <i [class]="getClassificationIcon('CO')"></i>
            <span>Capital Outlay</span>
          </div>
          <div class="classification-amount">{{ formatCurrency(stats.classificationBreakdown.CO) }}</div>
        </div>

        <div class="classification-card tr">
          <div class="classification-header">
            <i [class]="getClassificationIcon('TR')"></i>
            <span>Transfer</span>
          </div>
          <div class="classification-amount">{{ formatCurrency(stats.classificationBreakdown.TR) }}</div>
        </div>
      </div>
    </div>

    <!-- Recent Transactions -->
    <div class="recent-transactions-section">
      <div class="section-header">
        <h2>Recent Transactions</h2>
        <button class="refresh-btn" (click)="refreshData()">
          <i class="fas fa-refresh"></i>
          Refresh
        </button>
      </div>

      <div class="transactions-table" *ngIf="recentTransactions.length > 0">
        <div class="table-header">
          <div class="col-disbursement-no">Disbursement No.</div>
          <div class="col-payee">Payee</div>
          <div class="col-amount">Amount</div>
          <div class="col-classification">Classification</div>
          <div class="col-date">Date</div>
          <div class="col-status">Status</div>
        </div>

        <div class="table-row" *ngFor="let transaction of recentTransactions">
          <div class="col-disbursement-no">{{ transaction.disbursementNo }}</div>
          <div class="col-payee">{{ transaction.payee }}</div>
          <div class="col-amount">{{ formatCurrency(transaction.amount) }}</div>
          <div class="col-classification">
            <span [class]="'classification-badge ' + transaction.classification.toLowerCase()">
              <i [class]="getClassificationIcon(transaction.classification)"></i>
              {{ transaction.classification }}
            </span>
          </div>
          <div class="col-date">{{ formatDate(transaction.disbursementDate) }}</div>
          <div class="col-status">
            <span [class]="'status-badge ' + getStatusClass(transaction.status)">
              {{ transaction.status }}
            </span>
          </div>
        </div>
      </div>

      <div class="no-data" *ngIf="recentTransactions.length === 0">
        <i class="fas fa-inbox"></i>
        <p>No recent transactions found</p>
      </div>
    </div>

    <!-- Quick Actions -->
    <div class="quick-actions-section" *ngIf="canEdit()">
      <h2>Quick Actions</h2>
      <div class="actions-grid">
        <a routerLink="/disbursements/new" class="action-card">
          <i class="fas fa-plus"></i>
          <span>New Disbursement</span>
        </a>
        <a routerLink="/reports" class="action-card">
          <i class="fas fa-chart-bar"></i>
          <span>Generate Report</span>
        </a>
        <a routerLink="/disbursements" class="action-card">
          <i class="fas fa-list"></i>
          <span>View All</span>
        </a>
        <a *ngIf="canManageUsers()" routerLink="/admin/users" class="action-card">
          <i class="fas fa-users"></i>
          <span>Manage Users</span>
        </a>
      </div>
    </div>
  </div>
</div>